import{b as ie,c as oe}from"./chunk-E6SGW5BC.js";import{a as w}from"./chunk-TNWMNFDH.js";import"./chunk-FDTJR2YF.js";import{a as H,b as U,d as j}from"./chunk-JCBPD6RT.js";import{d as X,e as Y,f as Z,g as ee,h as te,j as ne}from"./chunk-5TCGGAAG.js";import{a as W,b as P}from"./chunk-UB744ET5.js";import"./chunk-RBDLR5TA.js";import{b as K}from"./chunk-J2PD257E.js";import{Z as G,_ as J}from"./chunk-VSXP2TIN.js";import"./chunk-YIVORG43.js";import"./chunk-FX7X3JHI.js";import"./chunk-Q7EBID5A.js";import{Bb as g,C as E,Fa as Q,Hb as x,Ic as A,Kb as k,Lb as L,Mb as s,Nb as l,Ob as f,Sb as z,Yb as C,_b as a,cb as r,fc as F,gc as N,ha as y,hc as V,ic as c,kb as O,kc as v,mc as b,nc as h,ob as S,oc as d,qc as R,ra as p,rb as I,sa as m,tc as D,ub as _,vc as $,wc as B}from"./chunk-JHZPYHNQ.js";import"./chunk-4CLCTAJ7.js";var T=class i{transform(t,e){return e.has(t)?e.get(t).answers.length>0:!1}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=I({name:"isHaveAnswer",type:i,pure:!1})};var ae=["quizContainer"],ue=()=>[],se=(i,t)=>t.id;function le(i,t){if(i&1&&(s(0,"h2",12),c(1),l(),f(2,"router-outlet")),i&2){a();let e=d(7);r(),v("\u0412\u043E\u043F\u0440\u043E\u0441 \u2116",e.id,"")}}function ce(i,t){if(i&1){let e=z();s(0,"div",7)(1,"button",8),C("click",function(){p(e),a();let o=d(6),u=a();return m(u.changeCurrentQuestionIndex(o-1))}),f(2,"nz-icon",13),c(3," \u041F\u0440\u0435\u0434\u044B\u0434\u0443\u0449\u0438\u0439 \u0432\u043E\u043F\u0440\u043E\u0441 "),l(),s(4,"button",8),C("click",function(){p(e),a();let o=d(6),u=a();return m(u.changeCurrentQuestionIndex(o+1))}),c(5," \u0421\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u0432\u043E\u043F\u0440\u043E\u0441 "),f(6,"nz-icon",14),l()()}if(i&2){a();let e=d(6);a();let n=d(1);r(),g("disabled",e===1),r(3),g("disabled",e===n[n.length-1].id)}}function de(i,t){i&1&&f(0,"div",16)}function pe(i,t){if(i&1){let e=z();b(0)(1),D(2,"isHaveAnswer"),s(3,"button",15),C("click",function(){let o=p(e).$implicit,u=a(2);return m(u.changeCurrentQuestionIndex(o.id))}),c(4),_(5,de,1,0,"div",16),l()}if(i&2){let e=t.$implicit;a();let n=d(7),o=e.id===(n==null?null:n.id),u=o?!1:$(2,4,e.id,a().userAnswers());r(3),g("nzType",o?"primary":"default")("disabled",o),r(),v(" ",e.id," "),r(),x(u?5:-1)}}function me(i,t){if(i&1){let e=z();s(0,"h1",2),c(1),l(),s(2,"h2",3),c(3),l(),s(4,"div",4,0),b(6)(7),s(8,"div",5)(9,"div",6),_(10,le,3,1),l(),_(11,ce,7,2,"div",7),s(12,"button",8),C("click",function(){p(e);let o=a(),u=d(1);return m(o.completeQuiz(u))}),c(13," \u0421\u0434\u0430\u0442\u044C \u0442\u0435\u0441\u0442 "),l()(),s(14,"div",9)(15,"h3"),c(16,"\u041D\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u044F \u043F\u043E \u0442\u0435\u0441\u0442\u0443"),l(),s(17,"div",10),k(18,pe,6,7,"button",11,se),l()()()}if(i&2){let e=a(),n=d(0),o=d(1);r(),v("\u0422\u0435\u0441\u0442: ",n==null?null:n.label,""),r(2),v("\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0432\u043E\u043F\u0440\u043E\u0441\u043E\u0432: ",o.length,""),r(3);let u=h(e.currentQuestionIndex());r();let q=h(e.question());r(3),x(q?10:-1),r(),x(u!==null?11:-1),r(),g("disabled",!q),r(6),L(o)}}function _e(i,t){if(i&1){let e=z();s(0,"button",18),C("click",function(){p(e);let o=a(2);return m(o.goToMain())}),c(1,"\u041D\u0430 \u0433\u043B\u0430\u0432\u043D\u0443\u044E"),l()}}function ge(i,t){if(i&1&&(f(0,"nz-empty",17),_(1,_e,2,0,"ng-template",null,1,B)),i&2){let e=V(2);g("nzNotFoundFooter",e)}}var M=class i{storeService=y(K);router=y(j);nzModalService=y(ie);selectedTestOption=P(this.storeService.selectedTest$,{initialValue:null});testQuestions=P(this.storeService.testQuestions$,{initialValue:null});userAnswers=P(this.storeService.testResults$,{initialValue:new Map});currentQuestionIndex=Q(null);quizContainerElement=O("quizContainer");question=A(()=>(this.testQuestions()??[]).find(n=>n.id===this.currentQuestionIndex())??null);constructor(){this.handleRouteChange(this.router.url),this.router.events.pipe(E(t=>t instanceof H),W()).subscribe(t=>{this.handleRouteChange(t.url)})}changeCurrentQuestionIndex(t){this.router.navigateByUrl(`/${w.quiz}/${t}`)}completeQuiz(t){let e=[];for(let[n,o]of this.userAnswers())o.answers.length>0&&e.push(n);this.nzModalService.confirm({nzTitle:"\u0412\u044B \u0445\u043E\u0442\u0438\u0442\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044C \u0442\u0435\u0441\u0442?",nzContent:`\u0412\u044B \u043E\u0442\u0432\u0435\u0442\u0438\u043B\u0438 \u043D\u0430 ${e.length} \u0438\u0437 ${t.length} \u0432\u043E\u043F\u0440\u043E\u0441\u043E\u0432`,nzCancelText:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",nzOkText:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044C \u0442\u0435\u0441\u0442",nzMaskClosable:!0,nzOnOk:()=>{this.router.navigateByUrl(`/${w.result}`),this.storeService.setSelectedTest(null)}})}goToMain(){this.router.navigateByUrl(`/${w.start}`)}handleRouteChange(t){let[,,e]=t.split("/");this.currentQuestionIndex.set(Number(e));let n=this.quizContainerElement()??null;n!==null&&n.nativeElement.scrollTo({top:0,left:0,behavior:"smooth"})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=S({type:i,selectors:[["app-quiz-page"]],viewQuery:function(e,n){e&1&&F(n.quizContainerElement,ae,5),e&2&&N()},decls:4,vars:4,consts:[["quizContainer",""],["footerTpl",""],[1,"quiz-title"],[1,"quiz-subtitle"],[1,"quiz-container"],[1,"quiz-container-left"],[1,"quiz-question"],[1,"quiz-navigation"],["nz-button","","nzType","primary","type","button",3,"click","disabled"],[1,"quiz-container-right"],[1,"quiz-fast-navigation"],["nz-button","","type","button",1,"quiz-fast-navigation-question",3,"nzType","disabled"],[1,"quiz-question-title"],["nzType","left"],["nzType","right"],["nz-button","","type","button",1,"quiz-fast-navigation-question",3,"click","nzType","disabled"],[1,"quiz-fast-navigation-question-badge"],[1,"quiz-empty",3,"nzNotFoundFooter"],["nz-button","","nzType","primary","type","button",3,"click"]],template:function(e,n){if(e&1&&(b(0)(1),_(2,me,20,7)(3,ge,3,1)),e&2){let o,u=h(n.selectedTestOption());r();let q=h((o=n.testQuestions())!==null&&o!==void 0?o:R(3,ue));r(),x(u&&q.length>0?2:3)}},dependencies:[ee,Z,X,Y,ne,te,J,G,oe,U,T],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:0;height:100%;width:100%}.quiz-title[_ngcontent-%COMP%]{line-height:2rem}.quiz-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:2rem;height:0;flex:1;overflow-y:auto}.quiz-container-left[_ngcontent-%COMP%], .quiz-container-right[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:0}.quiz-container-left[_ngcontent-%COMP%]{flex:1;gap:1rem}.quiz-container-left[_ngcontent-%COMP%]   .quiz-navigation[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1rem}.quiz-container-right[_ngcontent-%COMP%]{--fast-navigation-columns: 7;--fast-navigation-column-width: 35px;overflow-y:auto;width:calc(var(--fast-navigation-columns) * var(--fast-navigation-column-width) + (var(--fast-navigation-columns) - 1) * .5rem + 18.68px)}.quiz-container-right[_ngcontent-%COMP%]   .quiz-fast-navigation[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(var(--fast-navigation-column-width),1fr));gap:.5rem;width:100%}.quiz-container-right[_ngcontent-%COMP%]   .quiz-fast-navigation-question[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:0;width:var(--fast-navigation-column-width);align-items:center;justify-content:center;position:relative}.quiz-container-right[_ngcontent-%COMP%]   .quiz-fast-navigation-question-badge[_ngcontent-%COMP%]{height:10px;width:10px;position:absolute;z-index:2;top:-5px;right:-5px;background-color:#87d068;border-radius:100%}.quiz-empty[_ngcontent-%COMP%]{margin:auto}@media screen and (max-width: 1200px){.quiz-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.quiz-container-left[_ngcontent-%COMP%]{flex:none}.quiz-container-right[_ngcontent-%COMP%]{width:100%;min-height:fit-content}}@media screen and (max-width: 500px){.quiz-navigation[_ngcontent-%COMP%]   .ant-btn[_ngcontent-%COMP%]  span{display:none}.quiz-navigation[_ngcontent-%COMP%]   .ant-btn[_ngcontent-%COMP%]  .anticon{margin:0}}"],changeDetection:0})};export{M as default};
