import{a as Z,b as ee,c as te,d as ne,e as ie,f as oe,g as re,h as se}from"./chunk-KDAF76SH.js";import{e as $,f as G,h as j,j as U}from"./chunk-2PLA4Y5Z.js";import{d as W,e as H,f as J,g as K,h as X,j as Y}from"./chunk-BAWH47OO.js";import{a as I,b as w}from"./chunk-SZYELMMS.js";import"./chunk-XTMMDLFS.js";import{a as R}from"./chunk-5EVNWBFJ.js";import{Z as B,_ as L}from"./chunk-4I6IVQI2.js";import"./chunk-NAH5QJVK.js";import"./chunk-7QSQE4VK.js";import"./chunk-6IKGMKHR.js";import{Ab as p,Da as Q,Fa as M,Fc as O,Gb as c,Gc as E,Jb as z,Kb as g,Lb as s,Mb as a,Nb as l,Rb as x,Xb as b,Zb as u,cb as o,fc as m,gc as N,ha as A,hc as h,jc as v,kc as P,lc as _,nb as F,qb as S,qc as D,ra as C,rc as k,sa as f,tb as d}from"./chunk-ZO5JOBJ4.js";import{a as q,b as V}from"./chunk-4CLCTAJ7.js";var y=class t{transform(n){return n==null?!0:Array.isArray(n)?n.length===0:!1}static \u0275fac=function(e){return new(e||t)};static \u0275pipe=S({name:"isDisabled",type:t,pure:!0})};var le=(t,n)=>n.id;function ce(t,n){t&1&&l(0,"nz-empty")}function de(t,n){t&1&&l(0,"nz-icon",9)}function me(t,n){t&1&&l(0,"nz-icon",10)}function pe(t,n){if(t&1&&(s(0,"label",8),m(1),d(2,de,1,0,"nz-icon",9)(3,me,1,0,"nz-icon",10),a()),t&2){let e=n.$implicit,i=u(4);p("nzValue",e.id),o(),h(" ",e.value," "),o(),c(i.isAnswerVisible()&&e.isCorrect?2:-1),o(),c(i.isAnswerVisible()&&!e.isCorrect?3:-1)}}function _e(t,n){if(t&1&&(s(0,"nz-checkbox-group",7),z(1,pe,4,4,"label",8,le),a()),t&2){let e=u(3),i=_(0);p("formControl",e.questionFormControl),o(),g(i.answers)}}function Ce(t,n){t&1&&l(0,"nz-icon",9)}function fe(t,n){t&1&&l(0,"nz-icon",10)}function xe(t,n){if(t&1&&(s(0,"label",11),m(1),d(2,Ce,1,0,"nz-icon",9)(3,fe,1,0,"nz-icon",10),a()),t&2){let e=n.$implicit,i=u(4);p("nzValue",e.id),o(),h(" ",e.value," "),o(),c(i.isAnswerVisible()&&e.isCorrect?2:-1),o(),c(i.isAnswerVisible()&&!e.isCorrect?3:-1)}}function be(t,n){if(t&1&&(s(0,"nz-radio-group",7),z(1,xe,4,4,"label",11,le),a()),t&2){let e=u(3),i=_(0);p("formControl",e.questionFormControl),o(),g(i.answers)}}function we(t,n){if(t&1&&(s(0,"div",5),m(1),a(),l(2,"nz-divider",6),d(3,_e,3,1,"nz-checkbox-group",7)(4,be,3,1,"nz-radio-group",7)),t&2){u(2);let e=_(0);o(),N(e.question),o(2),c(e.isMultiple?3:4)}}function ye(t,n){if(t&1){let e=x();s(0,"button",12),b("click",function(){C(e);let r=u(2);return f(r.changeAnswerVisibility())}),l(1,"nz-icon",13),m(2," \u0421\u043A\u0440\u044B\u0442\u044C \u043E\u0442\u0432\u0435\u0442\u044B "),a()}}function ze(t,n){if(t&1){let e=x();s(0,"button",12),b("click",function(){C(e);let r=u(2);return f(r.changeAnswerVisibility())}),l(1,"nz-icon",14),m(2," \u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043E\u0442\u0432\u0435\u0442\u044B "),a()}}function ge(t,n){if(t&1){let e=x();s(0,"div",0),d(1,ce,1,0,"nz-empty")(2,we,5,2),a(),s(3,"div",1),v(4),D(5,"isDisabled"),s(6,"button",2),b("click",function(){C(e);let r=u();return f(r.clearAnswers())}),l(7,"nz-icon",3),m(8," \u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C \u043E\u0442\u0432\u0435\u0442\u044B "),a(),d(9,ye,3,0,"button",4)(10,ze,3,0,"button",4),a()}if(t&2){let e=u(),i=_(0);o(),c(i.question.length===0?1:2);let r=k(5,3,e.questionFormControl.value);o(5),p("disabled",r),o(3),c(e.isAnswerVisible()?9:10)}}var ae=class t{storeService=A(R);questionId=Q(void 0,{alias:"id"});selectedTestOption=w(this.storeService.selectedTest$,{initialValue:null});testQuestions=w(this.storeService.testQuestions$,{initialValue:null});userAnswers=w(this.storeService.testResults$,{initialValue:new Map});isAnswerVisible=M(!1);question=O(()=>{let n=this.questionId();return n===void 0?null:(this.testQuestions()??[]).find(r=>String(r.id)===n)??null});questionFormControl=new G(null);constructor(){E(()=>{let n=this.question();n!==null&&this.addInitFormControlValue(n)}),this.questionFormControl.valueChanges.pipe(I()).subscribe(()=>{this.addAnswerToStore()})}changeAnswerVisibility(){this.isAnswerVisible.set(!this.isAnswerVisible())}clearAnswers(){this.questionFormControl.setValue(null)}addInitFormControlValue(n){let e=this.userAnswers().get(n.id)??null;if(e===null)this.questionFormControl.setValue(null);else{let i=e.answers;i.length===0?this.questionFormControl.setValue(null):this.questionFormControl.setValue(n.isMultiple?i:i[0])}}addAnswerToStore(){let n=this.questionFormControl.getRawValue()??[],e=Array.isArray(n)?n:[n],i=this.question();if(i!==null){let r={questionId:i.id,userAnswers:i.answers.map(T=>V(q({},T),{userChoice:e.includes(T.id)})),answers:e,testName:this.selectedTestOption()?.title??"",testQuestions:this.testQuestions()??[]};this.storeService.setTestResult(r)}}ngOnDestroy(){this.addAnswerToStore()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=F({type:t,selectors:[["app-question"]],inputs:{questionId:[1,"id","questionId"]},decls:2,vars:2,consts:[[1,"question"],[1,"actions"],["nz-button","","nzType","primary","type","button",3,"click","disabled"],["nzType","clear","nzTheme","outline"],["nz-button","","nzType","primary","type","button"],[1,"question-title"],[1,"question-divider"],[1,"question-answers",3,"formControl"],["nz-checkbox","",1,"question-answers-answer",3,"nzValue"],["nzType","check","nzTheme","outline",1,"question-answers-answer-correct"],["nzType","close","nzTheme","outline",1,"question-answers-answer-incorrect"],["nz-radio","",1,"question-answers-answer",3,"nzValue"],["nz-button","","nzType","primary","type","button",3,"click"],["nzType","eye-invisible","nzTheme","outline"],["nzType","eye","nzTheme","outline"]],template:function(e,i){if(e&1&&(v(0),d(1,ge,11,5)),e&2){let r=P(i.question());o(),c(r?1:-1)}},dependencies:[ie,ne,Y,X,K,J,W,H,L,B,U,$,j,se,re,oe,te,Z,ee,y],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:1rem}.question[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;padding:.75rem 1.25rem;border:1px solid transparent;border-radius:.25rem;box-sizing:border-box;background-color:#e9f6f8;border-color:#bee5eb}.question-title[_ngcontent-%COMP%]{font-weight:700;font-size:1.5rem;line-height:1.5rem}.question-divider[_ngcontent-%COMP%]{margin:0}.question-answers[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.question-answers-answer[_ngcontent-%COMP%]{font-size:1.25rem}.question-answers-answer-correct[_ngcontent-%COMP%]{color:#28a745;margin-left:.5rem}.question-answers-answer-incorrect[_ngcontent-%COMP%]{color:#ff5a5f;margin-left:.5rem}.actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1rem}@media screen and (max-width: 400px){.actions[_ngcontent-%COMP%]   .ant-btn[_ngcontent-%COMP%]  span{display:none}.actions[_ngcontent-%COMP%]   .ant-btn[_ngcontent-%COMP%]  .anticon{margin:0}}"],changeDetection:0})};export{ae as QuestionComponent};
